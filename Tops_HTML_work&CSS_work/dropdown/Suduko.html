<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        html {
  color: rgba(252, 250, 250, 0.834);
  font-family: Arial, Helvetica, sans-serif;
  background-color: rgba(0, 0, 0, 0.979);
}

body {
  margin: 0 auto;
  width: 700px;
  text-align: center;
}

p small {
  font-size: 9pt;
}

.hide {
  display: none;
}

.map {
  margin: 0 auto;
  width: fit-content;
  display: flex;
  flex-direction: column;
}

.map .row {
  display: flex;
  flex-direction: row;
}

.map .row .cell {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border: 1px solid rgb(173, 163, 163);
}

.map .row .cell.pre-fill {
  background-color: green;
}

.map .row[data-row="3"] .cell,
.map .row[data-row="6"] .cell {
  border-bottom-width: 4px;
}

.map .row .cell[data-column="3"],
.map .row .cell[data-column="6"] {
  border-right-width: 4px;
}

.command-bar {
  margin-top: 20px;
  
  /* color: black; */
  /* background-color: darkslategrey; */
}

.command-bar button {
  margin-left: 10px;
  height: 40px;
  width: 70px;
  font-size: 20px;
}

.command-bar button:first-of-type {
  margin-left: 0;
}

.message-no-solution,
.message-invalid-map {
  color: red;
}

    </style>
</head>
<body>
    <h1>Solve Sudoku</h1>
<div class="map">
  <div class="row" data-row="1">
    <div class="cell" onclick="sudoku.increment(0, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(0, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(0, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(0, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(0, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(0, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(0, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(0, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(0, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="2">
    <div class="cell" onclick="sudoku.increment(1, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(1, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(1, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(1, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(1, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(1, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(1, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(1, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(1, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="3">
    <div class="cell" onclick="sudoku.increment(2, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(2, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(2, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(2, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(2, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(2, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(2, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(2, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(2, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="4">
    <div class="cell" onclick="sudoku.increment(3, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(3, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(3, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(3, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(3, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(3, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(3, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(3, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(3, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="5">
    <div class="cell" onclick="sudoku.increment(4, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(4, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(4, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(4, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(4, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(4, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(4, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(4, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(4, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="6">
    <div class="cell" onclick="sudoku.increment(5, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(5, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(5, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(5, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(5, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(5, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(5, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(5, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(5, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="7">
    <div class="cell" onclick="sudoku.increment(6, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(6, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(6, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(6, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(6, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(6, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(6, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(6, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(6, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="8">
    <div class="cell" onclick="sudoku.increment(7, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(7, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(7, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(7, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(7, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(7, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(7, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(7, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(7, 8)" data-column="9"></div>
  </div>
  <div class="row" data-row="9">
    <div class="cell" onclick="sudoku.increment(8, 0)" data-column="1"></div>
    <div class="cell" onclick="sudoku.increment(8, 1)" data-column="2"></div>
    <div class="cell" onclick="sudoku.increment(8, 2)" data-column="3"></div>
    <div class="cell" onclick="sudoku.increment(8, 3)" data-column="4"></div>
    <div class="cell" onclick="sudoku.increment(8, 4)" data-column="5"></div>
    <div class="cell" onclick="sudoku.increment(8, 5)" data-column="6"></div>
    <div class="cell" onclick="sudoku.increment(8, 6)" data-column="7"></div>
    <div class="cell" onclick="sudoku.increment(8, 7)" data-column="8"></div>
    <div class="cell" onclick="sudoku.increment(8, 8)" data-column="9"></div>
  </div>
</div>

<div class="command-bar">
  <button onclick="sudoku.reset()">Reset</button>
  <button onclick="sudoku.solve()">Solve</button>
</div>
</body>
</html>
<script>
        const sudoku = {
  hasSolution: null,
  canUpdate: true,
  map: [
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ],
    [
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 },
      { value: 0 }
    ]
  ],

  load(map) {
    for (let rowIndex = 0; rowIndex < map.length; rowIndex++) {
      for (
        let columnIndex = 0;
        columnIndex < map[rowIndex].length;
        columnIndex++
      )
        this.map[rowIndex][columnIndex] = { value: map[rowIndex][columnIndex] };
    }
    this.canUpdate = false;
    this.hasSolution = null;
    this._notifyPropertyChanged("map", "canUpdate", "hasSolution", "isValid");
  },

  reset() {
    for (let rowIndex = 0; rowIndex < this.map.length; rowIndex++) {
      for (
        let columnIndex = 0;
        columnIndex < this.map[rowIndex].length;
        columnIndex++
      )
        this.map[rowIndex][columnIndex] = { value: 0 };
    }
    this.canUpdate = true;
    this.hasSolution = null;
    this._notifyPropertyChanged("map", "canUpdate", "hasSolution", "isValid");
  },

  solve() {
    if (this.isValid) {
      const fillMap = this._getPreFillMap();

      let hasChnaged;
      do {
        hasChnaged = false;
        for (let rowIndex = 0; rowIndex < this.map.length; rowIndex++)
          for (
            let columnIndex = 0;
            columnIndex < this.map[rowIndex].length;
            columnIndex++
          ) {
            const value = this.map[rowIndex][columnIndex].value;
            if (value !== 0)
              for (let index = 0; index < 9; index++) {
                let candidates = fillMap[rowIndex][index];
                let candidateIndex = candidates.indexOf(value);
                if (candidateIndex >= 0) candidates.splice(candidateIndex, 1);

                candidates = fillMap[index][columnIndex];
                candidateIndex = candidates.indexOf(value);
                if (candidateIndex >= 0) candidates.splice(candidateIndex, 1);

                candidates =
                  fillMap[Math.floor(rowIndex / 3) * 3 + Math.floor(index / 3)][
                    Math.floor(columnIndex / 3) * 3 + Math.floor(index % 3)
                  ];
                candidateIndex = candidates.indexOf(value);
                if (candidateIndex >= 0) candidates.splice(candidateIndex, 1);
              }
          }

        for (let rowIndex = 0; rowIndex < this.map.length; rowIndex++)
          for (
            let columnIndex = 0;
            columnIndex < this.map[rowIndex].length;
            columnIndex++
          ) {
            if (fillMap[rowIndex][columnIndex].length === 1) {
              this.map[rowIndex][columnIndex] = {
                value: fillMap[rowIndex][columnIndex][0],
                isPreFill: true
              };
              hasChnaged = true;
            }
          }
      } while (hasChnaged);

      this.hasSolution = this.map.every((row) =>
        row.every((cell) => cell.value !== 0)
      );

      this._notifyPropertyChanged("map", "hasSolution", "canUpdate");
    }
  },

  increment(rowIndex, columnIndex) {
    if (this.canUpdate) {
      this.map[rowIndex][columnIndex].value = Math.floor(
        (this.map[rowIndex][columnIndex].value + 1) % 10
      );
      this._notifyPropertyChanged("map", "isValid");
    }
  },

  get isValid() {
    for (let rowIndex = 0; rowIndex < this.map.length; rowIndex++)
      for (
        let columnIndex = 0;
        columnIndex < this.map[rowIndex].length;
        columnIndex++
      ) {
        const value = this.map[rowIndex][columnIndex].value;
        let duplicates = 0;

        if (value !== 0)
          for (let index = 0; index < 9; index++)
            if (
              this.map[rowIndex][index].value === value &&
              index !== columnIndex
            )
              return false;
            else if (
              this.map[index][columnIndex].value === value &&
              index !== rowIndex
            )
              return false;
            else {
              const sectionRowIndex =
                Math.floor(rowIndex / 3) * 3 + Math.floor(index / 3);
              const sectionColumnIndex =
                Math.floor(columnIndex / 3) * 3 + Math.floor(index % 3);
              if (
                this.map[sectionRowIndex][sectionColumnIndex].value == value &&
                rowIndex !== sectionRowIndex &&
                columnIndex !== sectionColumnIndex
              )
                return false;
            }
      }

    return true;
  },

  _getPreFillMap() {
    const preFillMap = [];

    for (let rowIndex = 0; rowIndex < this.map.length; rowIndex++) {
      preFillMap.push([]);
      for (
        let columnIndex = 0;
        columnIndex < this.map[rowIndex].length;
        columnIndex++
      ) {
        preFillMap[rowIndex].push();
        const value = this.map[rowIndex][columnIndex].value;
        preFillMap[rowIndex][columnIndex] =
          value === 0 ? [1, 2, 3, 4, 5, 6, 7, 8, 9] : [];
      }
    }

    return preFillMap;
  },

  _notifyPropertyChanged(...props) {
    if (props.indexOf("map") >= 0)
      document.querySelectorAll(".map .row").forEach((rowElement, rowIndex) => {
        rowElement.querySelectorAll(".cell").forEach((cell, columnIndex) => {
          const cellData = this.map[rowIndex][columnIndex];
          cell.innerText = cellData.value === 0 ? "" : cellData.value;
          cell.className = cellData.isPreFill ? "cell pre-fill" : "cell";
        });
      });

    if (props.indexOf("hasSolution") >= 0)
      document.querySelector(".message-no-solution").className =
        this.hasSolution === true || this.hasSolution === null
          ? "message-no-solution hide"
          : "message-no-solution";

    if (props.indexOf("isValid") >= 0)
      document.querySelector(".message-invalid-map").className = this.isValid
        ? "message-invalid-map hide"
        : "message-invalid-map";
  }
};

sudoku.load([
  [8, 6, 0, 7, 0, 2, 0, 0, 5],
  [0, 0, 2, 0, 4, 0, 0, 0, 0],
  [0, 5, 4, 6, 0, 1, 0, 7, 0],

  [0, 2, 9, 0, 0, 0, 0, 5, 0],
  [3, 0, 0, 9, 0, 8, 0, 0, 7],
  [0, 8, 0, 0, 0, 0, 1, 4, 0],

  [0, 9, 0, 3, 0, 7, 2, 8, 0],
  [0, 0, 0, 0, 8, 0, 5, 0, 0],
  [5, 0, 0, 2, 0, 4, 0, 9, 1]
]);

</script>